import{a1 as p,a2 as m,A as a}from"./CMCxBn70.js";import{Q as h}from"./CmudrWh9.js";import{b}from"./BvTYNhO9.js";import{u as v}from"./Cb26PGfG.js";import"./C7JPyPC4.js";const c=["/","/register","/login"],x=p(async(o,E)=>{var n,i,u;let t,s;const r=new AbortController;try{if(c.includes(o.path))return;const e=b("cookie"),_=(n=e==null?void 0:e.split(";").find(f=>f.includes("token")))==null?void 0:n.split("="),{data:l,status:d}=([t,s]=m(()=>v("/api/auth/verify-token",{key:h.VERIFIED_TOKEN,signal:r.signal},"$3Szstf5fnx")),t=await t,s(),t);if(d.value==="error"||!((i=l.value)!=null&&i.data))return r.abort(),a("/");if((u=l.value)!=null&&u.data&&c.includes(o.path))return r.abort(),a("/dashboard")}catch(e){return console.error("Error !!, Auth middleware: ",e),r.abort(),a("/")}});export{x as default};
