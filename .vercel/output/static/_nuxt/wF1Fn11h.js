var Z=Object.defineProperty;var ee=(h,s,t)=>s in h?Z(h,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[s]=t;var F=(h,s,t)=>ee(h,typeof s!="symbol"?s+"":s,t);import O from"./GQPUnmNe.js";import{_ as R}from"./DmH-Knno.js";import{_ as te,u as se}from"./CDB0gn6M.js";import{_ as U}from"./DKWuPxmd.js";import{d as I,r as T,g as z,a as f,b as u,v as P,h as e,j as p,x as S,q as $,k as x,B as w,E as H,F as L,D as V,t as m,u as n,C as k,l as D,p as K,c as Y,G as ae,o as ne,T as q,U as oe,A as N,z as J}from"./CMCxBn70.js";import{L as C,E as Q,A as G}from"./CL0K_7W2.js";import{u as ie,_ as re}from"./C7JPyPC4.js";import{e as le}from"./B6_maDk3.js";import{b as W}from"./BvTYNhO9.js";import{u as de}from"./M9v_ylco.js";import{a as ce}from"./D2lfmPiW.js";import"./CqkleIqs.js";import"./CtYnR-GE.js";import"./Cb26PGfG.js";async function ue(h,s){const t=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${h}&lon=${s}&addressdetails=1`,a=await fetch(t,{headers:{"User-Agent":"YourCoolApp/1.0 (your@email.com)"}});if(!a.ok)throw new Error("Failed to reverse geocode");return(await a.json()).display_name}const pe={class:"w-full flex items-center justify-start gap-3 mb-4 col-span-2"},me=["value"],fe=["value"],ye={key:1,class:"flex w-full min-h-[22rem] bg-secondary/50 p-2 flex items-center justify-center col-span-2"},ve={class:"flex flex-col items-center justify-center w-full p-4"},_e={class:"flex items-center justify-center bg-secondary/40 backdrop-blur-md shadow-sm rounded-full aspect-square p-4 mt-6"},ge={key:2,class:"flex flex-col w-full col-span-2 items-center gap-3 mt-4 bg-secondary/30 backdrop-blur-md rounded-lg p-4"},be={class:"text-text-secondary place-self-start"},xe={class:"flex items-center justify-center bg-secondary/40 backdrop-blur-md shadow-sm rounded-full aspect-square p-4 mt-6"},he=["placeholder"],we={class:"flex-1 col-span-2 flex items-center justify-end gap-3"},Ee=I({keepAlive:!0,__name:"TypeAndLocation",emits:["next","back"],setup(h,{emit:s}){const t=T({eventType:!1,locationType:!1,location:!1}),a=T({event_type:Q.EVENT,location:"",location_type:C.OFFLINE,location_coordinates:{lat:31.19555225,lng:29.938382000000004}}),{data:o,refresh:g}=ie("addressDetails",async()=>{const{lat:b,lng:c}=a.value.location_coordinates;return await ue(b,c)},{immediate:!0,watch:[()=>a.value.location_coordinates]});z(o,b=>{b&&(a.value.location=b)},{immediate:!0,deep:!0});const j=s;z(()=>a.value.location_type,async b=>{b===C.ONLINE?a.value.location="":a.value.location=o.value||""});const l=()=>{j("next",a.value)};return(b,c)=>{const E=O,y=R,i=te,_=U;return u(),f("form",{action:"",onSubmit:P(l,["prevent"]),class:"w-full p-3 grid grid-cols-1 sm:grid-cols-2 gap-3 mt-5 glass-card"},[e("span",pe,[e("button",{type:"button",class:"flex items-center justify-center size-8 rounded-md bg-secondary/60 hover:bg-secondary/40 transition-colors",onClick:c[0]||(c[0]=d=>j("back")),"aria-label":"go back","aria-labelledby":"go-back-button","aria-describedby":"go-back-button",title:"go back"},[p(E,{name:"i-heroicons-arrow-left-solid",class:"text-accent cursor-pointer"})]),c[9]||(c[9]=e("h3",{class:"text-lg font-semibold text-accent/70 col-span-2"}," Event type and location ",-1))]),p(y,{label:"event type",id:"event-type","error-condition":t.value.eventType&&!a.value.event_type,"error-message":"the event type is required !",direction:"col"},{default:x(()=>[w(e("select",{name:"event-type",id:"event-type","onUpdate:modelValue":c[1]||(c[1]=d=>a.value.event_type=d),onBlur:c[2]||(c[2]=()=>t.value.eventType=!0),class:"input"},[(u(!0),f(L,null,V(Object.values(n(Q)),d=>(u(),f("option",{value:d},m(d),9,me))),256)),c[10]||(c[10]=e("option",{value:"other"},"Other",-1))],544),[[H,a.value.event_type]])]),_:1},8,["error-condition"]),p(y,{label:"location-type",id:"location-type","error-condition":t.value.locationType&&!a.value.location_type,"error-message":"select event location type !",direction:"col"},{default:x(()=>[w(e("select",{name:"event-type",id:"event-type","onUpdate:modelValue":c[3]||(c[3]=d=>a.value.location_type=d),onBlur:c[4]||(c[4]=()=>t.value.locationType=!0),class:"input"},[(u(!0),f(L,null,V(Object.values(n(C)),d=>(u(),f("option",{value:d},m(d),9,fe))),256))],544),[[H,a.value.location_type]])]),_:1},8,["error-condition"]),a.value.location_type===n(C).OFFLINE?(u(),S(y,{key:0,label:"location",id:"location","error-condition":t.value.location&&!a.value.location,"error-message":"the location is required !",direction:"col"},{default:x(()=>[w(e("input",{type:"text",name:"location",id:"location","onUpdate:modelValue":c[5]||(c[5]=d=>a.value.location=d),onBlur:c[6]||(c[6]=()=>t.value.location=!0),class:"input",placeholder:"enter the event location ..."},null,544),[[k,a.value.location]])]),_:1},8,["error-condition"])):$("",!0),a.value.location_type===n(C).OFFLINE?(u(),f("div",ye,[p(i,{class:"h-full rounded-lg",modelValue:a.value.location_coordinates,"onUpdate:modelValue":c[7]||(c[7]=d=>a.value.location_coordinates=d)},null,8,["modelValue"]),e("span",ve,[c[11]||(c[11]=e("h3",{class:"text-text-primary text-lg mt-2 max-w-2/3 text-center"}," Please select the location on the map above. ",-1)),e("span",_e,[p(E,{name:"hugeicons:maps-location-01",class:"text-4xl text-accent mt-2"})])])])):$("",!0),a.value.location_type===n(C).ONLINE?(u(),f("div",ge,[e("h5",be," Please enter the link to your "+m(a.value.event_type)+". ",1),e("span",xe,[p(E,{name:"hugeicons:link-03",class:"text-4xl text-accent mt-2 leading-3 !mt-0"})]),w(e("input",{type:"url",name:"event_url",id:"event_url","onUpdate:modelValue":c[8]||(c[8]=d=>a.value.location=d),class:"input w-full",placeholder:`Enter the ${a.value.event_type} URL...`},null,8,he),[[k,a.value.location]])])):$("",!0),e("div",we,[p(_,{type:"submit",disabled:!a.value.event_type||!a.value.location||a.value.location_type===n(C).OFFLINE&&!a.value.location_coordinates},{default:x(()=>[c[12]||(c[12]=D(" Next ")),p(E,{name:"i-heroicons-arrow-right-solid"})]),_:1,__:[12]},8,["disabled"])])],32)}}}),ke={class:"w-full flex items-center justify-start gap-3 mb-4 col-span-2"},$e={class:"flex-1 col-span-2 flex items-center justify-end gap-3"},Te=I({__name:"Schedule",emits:["next","back"],setup(h,{emit:s}){const t=T({startDate:!1,endDate:!1}),a=T({start_at:"",end_at:""}),o=s,g=()=>{o("next",a.value)};return(j,l)=>{const b=O,c=R,E=U;return u(),f("form",{action:"",onSubmit:P(g,["prevent"]),class:"w-full p-3 grid grid-cols-1 sm:grid-cols-2 gap-3 mt-5 glass-card"},[e("span",ke,[e("button",{type:"button",class:"flex items-center justify-center size-8 rounded-md bg-secondary/60 hover:bg-secondary/40 transition-colors",onClick:l[0]||(l[0]=y=>o("back")),"aria-label":"go back","aria-labelledby":"go-back-button","aria-describedby":"go-back-button",title:"go back"},[p(b,{name:"i-heroicons-arrow-left-solid",class:"text-accent cursor-pointer"})]),l[5]||(l[5]=e("h3",{class:"text-lg font-semibold text-accent/70 col-span-2"}," Event Schedule and Timing ",-1))]),p(c,{label:"start date",id:"start-date","error-condition":n(t).startDate&&!n(a).start_at,"error-message":"the start date is required !",direction:"col"},{default:x(()=>[w(e("input",{type:"date",name:"start-date",id:"start-date","onUpdate:modelValue":l[1]||(l[1]=y=>n(a).start_at=y),onBlur:l[2]||(l[2]=()=>n(t).startDate=!0),class:"input"},null,544),[[k,n(a).start_at]])]),_:1},8,["error-condition"]),p(c,{label:"end date",id:"end-date","error-condition":n(t).endDate&&!n(a).end_at,"error-message":"the end date is required !",direction:"col"},{default:x(()=>[w(e("input",{type:"date",name:"end-date",id:"end-date","onUpdate:modelValue":l[3]||(l[3]=y=>n(a).end_at=y),onBlur:l[4]||(l[4]=()=>n(t).endDate=!0),class:"input"},null,544),[[k,n(a).end_at]])]),_:1},8,["error-condition"]),e("div",$e,[p(E,{type:"submit",disabled:!n(a).start_at||!n(a).end_at},{default:x(()=>[l[6]||(l[6]=D(" Next ")),p(b,{name:"i-heroicons-arrow-right-solid"})]),_:1,__:[6]},8,["disabled"])])],32)}}}),qe={class:"w-full flex items-center justify-start gap-3 mb-4"},De={class:"w-full flex items-start justify-start gap-8"},je={class:"w-[60%] flex flex-col gap-3"},Ce={class:"grid grid-cols-1 gap-3"},Be={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"},Se={class:"flex flex-col"},Fe={class:"text-xs text-text-secondary mb-3"},Ie={key:0,class:"text-red-700 leading-4 mt-2"},Ne={key:1,class:"text-red-700 leading-4 mt-2"},Ue={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Ae={class:"flex flex-col"},Le={class:"text-xs text-text-secondary mb-3"},Ve={key:0,class:"text-red-700 leading-4 mt-2"},Oe={key:1,class:"text-red-700 leading-4 mt-2"},Re={class:"flex flex-col"},Pe={class:"text-xs text-text-secondary mb-3"},ze={key:0,class:"text-red-700 leading-4 mt-2"},Qe={key:1,class:"text-red-700 leading-4 mt-2"},Ge={class:"flex-1 col-span-3 flex items-center justify-end gap-3 mt-3"},Me=["disabled"],Ye={class:"w-[40%] h-[68vh] flex flex-col gap-3 bg-card p-4 rounded-md"},Je={class:"flex flex-col gap-3 h-[calc(100%-4rem)] w-full"},He={key:0,class:"text-sm secondary-text text-center capitalize"},Ke={key:1,class:"flex flex-col gap-3 overflow-y-auto px-1"},We={class:"flex items-center justify-between py-1"},Xe={class:"text-base font-semibold text-accent/70 capitalize"},Ze={class:"text-sm text-black/70 font-semibold"},et={key:0,class:"text-sm text-black/40 py-1"},tt={class:"flex items-center justify-between"},st={class:"text-sm text-black/70"},at={class:"flex items-center justify-between"},nt={class:"text-sm text-black/80"},ot={class:"flex items-center justify-between"},it={class:"text-sm text-black/80 font-semibold"},rt={class:"flex items-center justify-between"},lt=["onClick"],dt={class:"flex-1 col-span-3 flex items-center justify-end gap-3 mt-5"},ct=I({__name:"TicketsAndPricing",props:{eventDate:{},eventCapacity:{}},emits:["back","next"],setup(h,{emit:s}){const t={START_DATE_REQUIRED:"The sale start date is required!",START_DATE_AFTER_EVENT:"The sale start date must be after the event start date or equal to!",END_DATE_REQUIRED:"The sale end date is required!",END_DATE_AFTER_EVENT:"The sale end date must be before the event end date or equal to!",QUANTITY_REQUIRED:"The quantity available is required!",QUANTITY_INVALID:"The quantity available must be greater than 0 and less than or equal to the event capacity!"},a=T([]),o=K({name:"",price:0,quantity_available:0,sale_start:new Date().toISOString().split("T")[0]+"T"+new Date().toLocaleTimeString("en-US",{hour12:!0}),sale_end:new Date().toISOString().split("T")[0]+"T"+new Date().toLocaleTimeString("en-US",{hour12:!0}),description:""}),g=T({name:!1,price:!1,quantity_available:!1,sale_start:!1,sale_end:!1,description:!1}),j=h,l=Y(()=>{const d=new Date,r=new Date(o.sale_start);return r>=d&&r<=new Date(j.eventDate.start_at)}),b=Y(()=>{const d=new Date,r=new Date(o.sale_end);return r>d&&r<=new Date(j.eventDate.end_at)}),c=Y(()=>o.quantity_available>0&&o.quantity_available<=j.eventCapacity),E=s,y=()=>{a.value.push({name:o.name,price:o.price,quantity_available:o.quantity_available,sale_start:o.sale_start,sale_end:o.sale_end,description:o.description,id:Math.floor(Math.random()*1e4)})},i=d=>{a.value=a.value.filter(r=>r.id!==d)},_=()=>{E("next",a.value.map(d=>({name:d.name,price:d.price,quantity_available:d.quantity_available,sale_start:d.sale_start,sale_end:d.sale_end,description:d.description,event_id:-1})))};return(d,r)=>{const B=O,A=R,M=U;return u(),f("form",{action:"",onSubmit:P(_,["prevent"]),class:"w-full flex flex-col p-3 mt-5 glass-card"},[e("span",qe,[e("button",{type:"button",class:"flex items-center justify-center size-8 rounded-md bg-secondary/60 hover:bg-secondary/40 transition-colors",onClick:r[0]||(r[0]=v=>E("back")),"aria-label":"go back","aria-labelledby":"go-back-button","aria-describedby":"go-back-button",title:"go back"},[p(B,{name:"i-heroicons-arrow-left-solid",class:"text-accent cursor-pointer"})]),r[12]||(r[12]=e("h3",{class:"text-lg font-semibold text-accent/70 col-span-2"}," choose tickets and pricing options ",-1))]),e("div",De,[e("div",je,[e("div",Ce,[e("span",Be,[p(A,{label:"name",id:"name","error-condition":n(g).name&&!n(o).name,"error-message":"the name is required !",direction:"col","is-required":""},{default:x(()=>[w(e("input",{type:"text",name:"name",id:"name","onUpdate:modelValue":r[1]||(r[1]=v=>n(o).name=v),onBlur:r[2]||(r[2]=()=>n(g).name=!0),class:"input",placeholder:"enter the ticket name ..."},null,544),[[k,n(o).name]])]),_:1},8,["error-condition"]),p(A,{label:"price",id:"price","error-condition":n(g).price&&n(o).price<0,"error-message":"the price is required !",direction:"col","is-required":""},{default:x(()=>[w(e("input",{type:"number",name:"price",id:"price","onUpdate:modelValue":r[3]||(r[3]=v=>n(o).price=v),onBlur:r[4]||(r[4]=()=>n(g).price=!0),class:"input",placeholder:"enter the ticket price ..."},null,544),[[k,n(o).price]])]),_:1},8,["error-condition"]),e("div",Se,[r[13]||(r[13]=e("label",{for:"quantity-available",class:"text-sm text-start text-text-primary font-medium capitalize leading-3"},[D("quantity available "),e("span",{class:"text-red-700 text-lg"},"*")],-1)),e("small",Fe,m(`Event capacity: ${d.eventCapacity}`),1),w(e("input",{type:"number",name:"quantity-available",id:"quantity-available","onUpdate:modelValue":r[5]||(r[5]=v=>n(o).quantity_available=v),onBlur:r[6]||(r[6]=()=>n(g).quantity_available=!0),class:"input"},null,544),[[k,n(o).quantity_available]]),n(g).sale_start&&!n(c)?(u(),f("small",Ie,m(`${t.QUANTITY_INVALID} (${d.eventCapacity})`),1)):n(g).quantity_available&&!n(o).quantity_available?(u(),f("small",Ne,m(t.QUANTITY_REQUIRED),1)):$("",!0)])]),e("span",Ue,[e("div",Ae,[r[14]||(r[14]=e("label",{for:"sale-start",class:"text-sm text-start text-text-primary font-medium capitalize leading-3"},[D("sale start "),e("span",{class:"text-red-700 text-lg"},"*")],-1)),e("small",Le,m(`Event date: ${d.eventDate.start_at}`),1),w(e("input",{type:"date",name:"sale-start",id:"sale-start","onUpdate:modelValue":r[7]||(r[7]=v=>n(o).sale_start=v),onBlur:r[8]||(r[8]=()=>n(g).sale_start=!0),class:"input"},null,544),[[k,n(o).sale_start]]),n(g).sale_start&&!n(l)?(u(),f("small",Ve,m(`${t.START_DATE_AFTER_EVENT} (${d.eventDate.start_at})`),1)):n(g).sale_start&&!n(o).sale_start?(u(),f("small",Oe,m(t.START_DATE_REQUIRED),1)):$("",!0)]),e("div",Re,[r[15]||(r[15]=e("label",{for:"sale-end",class:"text-sm text-start text-text-primary font-medium capitalize leading-3"},[D("sale end "),e("span",{class:"text-red-700 text-lg"},"*")],-1)),e("small",Pe,m(`Event date: ${d.eventDate.end_at}`),1),w(e("input",{type:"date",name:"sale-end",id:"sale-end","onUpdate:modelValue":r[9]||(r[9]=v=>n(o).sale_end=v),onBlur:r[10]||(r[10]=()=>n(g).sale_end=!0),class:"input"},null,544),[[k,n(o).sale_end]]),n(g).sale_end&&!n(b)?(u(),f("small",ze,m(`${t.END_DATE_AFTER_EVENT} (${d.eventDate.end_at})`),1)):n(g).sale_end&&!n(o).sale_end?(u(),f("small",Qe,m(t.END_DATE_REQUIRED),1)):$("",!0)])]),p(A,{label:"description",id:"description","error-condition":!1,"error-message":"",direction:"col",class:"w-full"},{default:x(()=>[w(e("textarea",{name:"description",id:"description",rows:"6","onUpdate:modelValue":r[11]||(r[11]=v=>n(o).description=v),class:"input",placeholder:"enter the ticket description ..."},null,512),[[k,n(o).description]])]),_:1})]),e("div",Ge,[e("button",{type:"button",class:"w-full flex items-center justify-center gap-2 bg-black text-white rounded-sm px-3 py-1.5 hover:bg-black/80 cursor-pointer disabled:opacity-50 transition-colors",onClick:y,disabled:!n(o).name||n(o).price<0||!n(c)||!n(l)||!n(b)},[r[16]||(r[16]=D(" add ticket ")),p(B,{name:"i-heroicons-plus-solid"})],8,Me)])]),e("div",Ye,[e("div",Je,[r[20]||(r[20]=e("h3",{class:"text-xl font-semibold text-accent/70 text-center"}," Preview ",-1)),n(a).length<1?(u(),f("p",He," no tickets added yet ")):(u(),f("ul",Ke,[(u(!0),f(L,null,V(n(a),(v,X)=>(u(),f("li",{key:X,class:"flex flex-col gap-1 glass-card shadow-sm p-3 rounded-md"},[e("span",We,[e("h4",Xe,m(v.name),1),e("p",Ze,m(v.price.toLocaleString("en-EG",{style:"currency",currency:"EGP"})),1)]),v.description?(u(),f("p",et,m(v.description),1)):$("",!0),e("span",tt,[r[17]||(r[17]=e("p",{class:"text-sm text-black/50"},"sale start",-1)),e("p",st,m(v.sale_start),1)]),e("span",at,[r[18]||(r[18]=e("p",{class:"text-sm text-black/50"},"sale end",-1)),e("p",nt,m(v.sale_end),1)]),e("span",ot,[p(B,{name:"i-heroicons-ticket-solid",class:"text-black/50 size-4"}),e("p",it,m(v.quantity_available)+" tickets ",1)]),e("span",rt,[e("button",{type:"button",class:"flex items-center justify-center gap-2 py-1 px-4 text-center text-sm font-semibold capitalize bg-red-200 text-red-700 rounded-sm hover:bg-red-300 transition-colors",onClick:Ht=>i(v.id)},[p(B,{name:"i-heroicons-trash-solid"}),r[19]||(r[19]=D(" remove "))],8,lt)])]))),128))]))]),e("div",dt,[p(M,{type:"submit",disabled:n(a).length<1},{default:x(()=>[r[21]||(r[21]=D(" Next ")),p(B,{name:"i-heroicons-arrow-right-solid"})]),_:1,__:[21]},8,["disabled"])])])])],32)}}}),ut={class:"flex flex-col w-full bg-secondary/50 p-4 rounded-md mt-5"},pt={class:"w-full flex flex-col items-center justify-start gap-3 mt-8"},mt={class:"w-full flex items-start justify-start gap-3"},ft={class:"shrink-0"},yt=["src"],vt={class:"flex flex-col items-start justify-start mt-2"},_t={class:"text-lg font-semibold capitalize text-text-primary"},gt={class:"text-text-secondary mb-4"},bt={class:"w-full grid grid-cols-3 items-center justify-start gap-3"},xt={class:"flex flex-col items-start justify-start gap-2"},ht={class:"text-text-primary"},wt={class:"flex flex-col items-start justify-start gap-2"},Et={class:"text-text-primary"},kt={class:"flex flex-col items-start justify-start gap-2"},$t={class:"text-text-primary"},Tt={class:"flex flex-col items-start justify-start gap-2"},qt={class:"text-text-primary"},Dt={class:"flex flex-col items-start justify-start gap-2"},jt={class:"text-text-primary"},Ct={class:"w-full md:max-w-2xl grid grid-cols-1 place-self-start"},Bt={class:"flex flex-col items-start justify-start gap-1 w-full"},St={class:"text-text-primary font-semibold"},Ft={class:"text-text-secondary"},It={class:"text-text-primary bg-white p-1 rounded-md"},Nt={class:"w-full flex gap-2 items-center justify-start gap-3 mt-5"},Ut=I({__name:"FinalEventCreate",props:{event:{}},emits:["onPublish","onSaveDraft","onBack"],setup(h){return(s,t)=>{const a=U;return u(),f("div",ut,[t[12]||(t[12]=e("h3",{class:"font-semibold text-2xl text-start text-accent/80"}," Finalize Event ",-1)),t[13]||(t[13]=e("p",{class:"secondary-text"},"Review your event details and publish it.",-1)),e("div",pt,[e("span",mt,[e("figure",ft,[e("img",{src:s.event.image,alt:"event-image",class:"w-56 h-44 object-cover rounded-md"},null,8,yt)]),e("span",vt,[e("h4",_t,m(s.event.name),1),e("p",gt,m(s.event.description),1),e("span",{class:ae([n(le)(s.event.event_type),"w-fir flex items-center justify-center gap-2 px-2 py-1 rounded-md"])},[e("p",null,m(s.event.event_type),1)],2)])]),e("span",bt,[e("span",xt,[t[3]||(t[3]=e("p",{class:"text-text-secondary"},"Date",-1)),e("p",ht,m(new Date(s.event.start_at).toLocaleDateString())+" - "+m(new Date(s.event.end_at).toLocaleDateString()),1)]),e("span",wt,[t[4]||(t[4]=e("p",{class:"text-text-secondary"},"Location",-1)),e("p",Et,m(s.event.location),1)]),e("span",kt,[t[5]||(t[5]=e("p",{class:"text-text-secondary"},"Capacity",-1)),e("p",$t,m(s.event.capacity),1)]),e("span",Tt,[t[6]||(t[6]=e("p",{class:"text-text-secondary"},"Audience",-1)),e("p",qt,m(s.event.audience),1)]),e("span",Dt,[t[7]||(t[7]=e("p",{class:"text-text-secondary"},"Event Type",-1)),e("p",jt,m(s.event.event_type),1)])]),t[8]||(t[8]=e("h3",{class:"text-lg text-text-secondary capitalize place-self-start mt-4"}," tickets ",-1)),e("ul",Ct,[(u(!0),f(L,null,V(s.event.tickets,(o,g)=>(u(),f("li",{key:g,class:"flex items-start justify-start gap-3 mb-2 bg-card p-3 rounded-md"},[e("span",Bt,[e("p",St,m(o.name),1),e("p",Ft,m(o.description),1),e("p",null,"available: "+m(o.quantity_available),1)]),e("p",It,m(o.price?`$${o.price}`:"Free"),1)]))),128))])]),e("div",Nt,[p(a,{variant:"outline",class:"me-auto",onClick:t[0]||(t[0]=o=>s.$emit("onBack"))},{default:x(()=>t[9]||(t[9]=[D(" go back")])),_:1,__:[9]}),p(a,{variant:"secondary",onClick:t[1]||(t[1]=o=>s.$emit("onPublish"))},{default:x(()=>t[10]||(t[10]=[D(" save draft ")])),_:1,__:[10]}),p(a,{variant:"default",onClick:t[2]||(t[2]=o=>s.$emit("onPublish"))},{default:x(()=>t[11]||(t[11]=[D(" publish ")])),_:1,__:[11]})])])}}});class At{constructor(s){F(this,"eventId",null);F(this,"cookies",W());this.event=s}async execute(){const s=await fetch("/api/events",{method:"POST",body:JSON.stringify(this.event),headers:{"Content-Type":"application/json",Cookie:this.cookies??""}}),t=await s.json();if(!s.ok)throw new Error(t.message||"Failed to create event");return this.eventId=t.data.id,t==null?void 0:t.data}async undo(){const s=await fetch(`/api/events/${this.eventId}`,{method:"DELETE",headers:{"Content-Type":"application/json",Cookie:this.cookies??""}});if(!s.ok){const t=await s.json();throw new Error(t.message||"Failed to delete event")}}}class Lt{constructor(s){F(this,"ticketTypeId",null);F(this,"cookies",W());this.ticketType=s}async execute(){const s=await fetch("/api/ticket-types",{method:"POST",body:JSON.stringify(this.ticketType),headers:{"Content-Type":"application/json",Cookie:this.cookies??""}}),t=await s.json();if(!s.ok)throw new Error(t.message||"Failed to create ticket type");return this.ticketTypeId=t.data.id,t}async undo(){const s=await fetch(`/api/ticket-types/${this.ticketTypeId}`,{method:"DELETE",headers:{"Content-Type":"application/json",Cookie:this.cookies??""}});if(!s.ok){const t=await s.json();throw new Error(t.message||"Failed to delete ticket type")}}}const Vt=()=>new Ot;class Ot{constructor(){F(this,"_form");F(this,"_formBlurred");this._form=K({name:"",image:"",description:"",start_at:"",end_at:"",event_type:Q.EVENT,capacity:0,location:"",location_type:C.OFFLINE,company_id:null,audience:G.PUBLIC,latitude:void 0,longitude:void 0,created_at:new Date().toISOString()}),this._formBlurred=K({})}get form(){return this._form}setName(s){return this._form.name=s,this}setImage(s){return this._form.image=s,this}setDescription(s){return this._form.description=s,this}setStartDate(s){return this._form.start_at=s,this}setEndDate(s){return this._form.end_at=s,this}setEventType(s){return this._form.event_type=s,this}setCapacity(s){return this._form.capacity=s,this}setLocation(s){return this._form.location=s,this}setLatitude(s){return this._form.latitude=s,this}setLongitude(s){return this._form.longitude=s,this}setLocationType(s){return this._form.location_type=s,this}setAudienceType(s){return this._form.audience=s,this}setCompanyId(s){return this._form.company_id=s,this}setFormBlurred(s,t){return this._formBlurred[s]=t,this}resetForm(){return this._form={name:"",image:"",description:"",start_at:"",end_at:"",event_type:Q.EVENT,capacity:0,location:"",location_type:C.OFFLINE,company_id:null,audience:G.PUBLIC,latitude:void 0,longitude:void 0,created_at:new Date().toISOString()},this}resetFormBlurred(){return this._formBlurred={},this}resetFormAndFormBlurred(){return this.resetForm(),this.resetFormBlurred(),this}buildForm(){if(!this._form.name)throw new Error("Event name is required");if(!this._form.start_at)throw new Error("Event start date is required");if(!this._form.end_at)throw new Error("Event end date is required");if(this._form.start_at>=this._form.end_at)throw new Error("Event end date must be after start date");if(this._form.capacity<0)throw new Error("Event capacity cannot be negative");if(this._form.location_type===C.OFFLINE&&!this._form.location)throw new Error("Event location is required for offline events");if(!this._form.event_type)throw new Error("Event type is required");if(!this._form.image)throw new Error("Event image is required");const s=new FormData;return Object.keys(this._form).forEach(t=>{const a=this._form[t]!==null&&this._form[t]!==void 0?this._form[t]:"";s.append(t,a)}),{formData:s,data:this._form}}}const Rt={class:"w-full flex items-center justify-start gap-3 mb-4 col-span-2"},Pt=["value"],zt={class:"flex-1 col-span-2 flex items-center justify-end gap-3 mt-8"},Qt=I({__name:"AudienceAndCapacity",emits:["next","back"],setup(h,{emit:s}){const t=s,a=T({capacity:!1,audience:!1,price:!1}),o=T({capacity:0,audience:G.PUBLIC,is_free:!1,price:0});z(()=>o.value.is_free,()=>{o.value.is_free&&(o.value.price=0)});const g=()=>{t("next",o.value)};return(j,l)=>{const b=O,c=R,E=U;return u(),f("form",{action:"",onSubmit:P(g,["prevent"]),class:"w-full p-3 grid grid-cols-1 sm:grid-cols-2 gap-3 mt-5 glass-card"},[e("span",Rt,[e("button",{type:"button",class:"flex items-center justify-center size-8 rounded-md bg-secondary/60 hover:bg-secondary/40 transition-colors",onClick:l[0]||(l[0]=y=>t("back")),"aria-label":"go back","aria-labelledby":"go-back-button","aria-describedby":"go-back-button",title:"go back"},[p(b,{name:"i-heroicons-arrow-left-solid",class:"text-accent cursor-pointer"})]),l[5]||(l[5]=e("h3",{class:"text-lg font-semibold text-accent/70 col-span-2"}," choose audience and capacity ",-1))]),p(c,{label:"capacity",id:"capacity","error-condition":n(a).capacity&&!n(o).capacity,"error-message":"the capacity is required !",direction:"col"},{default:x(()=>[w(e("input",{type:"number",name:"capacity",id:"capacity","onUpdate:modelValue":l[1]||(l[1]=y=>n(o).capacity=y),onBlur:l[2]||(l[2]=()=>n(a).capacity=!0),class:"input",placeholder:"enter the event capacity ..."},null,544),[[k,n(o).capacity]])]),_:1},8,["error-condition"]),p(c,{label:"audience",id:"audience","error-condition":n(a).audience&&!n(o).audience,"error-message":"the audience is required !",direction:"col"},{default:x(()=>[w(e("select",{name:"audience",id:"audience","onUpdate:modelValue":l[3]||(l[3]=y=>n(o).audience=y),onBlur:l[4]||(l[4]=()=>n(a).audience=!0),class:"input"},[l[6]||(l[6]=e("option",{value:"-1"},"Select audience",-1)),(u(!0),f(L,null,V(Object.values(n(G)),y=>(u(),f("option",{value:y},m(y),9,Pt))),256))],544),[[H,n(o).audience]])]),_:1},8,["error-condition"]),e("div",zt,[p(E,{type:"submit",disabled:!n(o).capacity||n(o).capacity<=0},{default:x(()=>[l[7]||(l[7]=D(" Next ")),p(b,{name:"i-heroicons-arrow-right-solid"})]),_:1,__:[7]},8,["disabled"])])],32)}}}),Gt={class:"flex-1 col-span-2 flex items-center justify-end gap-3"},Mt=I({__name:"BasicInfoForm",emits:["next","back"],setup(h,{emit:s}){const t=T({eventName:!1,eventImage:!1}),a=T({name:"",image:"",description:""}),o=s,g=()=>{o("next",a.value)};return(j,l)=>{const b=R,c=O,E=U;return u(),f("form",{action:"",onSubmit:P(g,["prevent"]),class:"w-full p-3 grid grid-cols-1 sm:grid-cols-2 gap-3 mt-5 glass-card"},[l[7]||(l[7]=e("span",{class:"w-full flex items-center justify-start gap-3 mb-4 col-span-2"},[e("h3",{class:"text-lg font-semibold text-accent/70 col-span-2"}," Basic Information ")],-1)),p(b,{label:"event name",id:"event-name","error-condition":t.value.eventName&&!a.value.name,"error-message":"the event name is required !",direction:"col",class:"col-span-2"},{default:x(()=>[w(e("input",{type:"text",name:"event-name",id:"event-name","onUpdate:modelValue":l[0]||(l[0]=y=>a.value.name=y),onBlur:l[1]||(l[1]=()=>t.value.eventName=!0),class:"input",placeholder:"enter the event name ..."},null,544),[[k,a.value.name]])]),_:1},8,["error-condition"]),p(b,{label:"event image",id:"event-image","error-condition":t.value.eventImage&&!a.value.image,"error-message":"the event image is required !",direction:"col",class:"col-span-2"},{default:x(()=>[w(e("input",{type:"text",name:"event-image",id:"event-image","onUpdate:modelValue":l[2]||(l[2]=y=>a.value.image=y),onBlur:l[3]||(l[3]=()=>t.value.eventImage=!0),class:"input",placeholder:"enter the event image url ..."},null,544),[[k,a.value.image]])]),_:1},8,["error-condition"]),p(b,{label:"description",id:"description","error-condition":!1,"error-message":"",direction:"col",class:"col-span-2"},{default:x(()=>[w(e("textarea",{name:"description",id:"description",rows:"6","onUpdate:modelValue":l[4]||(l[4]=y=>a.value.description=y),class:"input",placeholder:"enter the event description ..."},null,512),[[k,a.value.description]])]),_:1}),e("div",Gt,[p(E,{type:"submit",size:"sm",onClick:l[5]||(l[5]=y=>o("next",{name:a.value.name,image:a.value.image,description:a.value.description})),disabled:!a.value.name||!a.value.image},{default:x(()=>[l[6]||(l[6]=e("p",{class:"text-white text-sm"},"Next",-1)),p(c,{name:"i-heroicons-arrow-right-solid"})]),_:1,__:[6]},8,["disabled"])])],32)}}}),Yt={class:"p-4 w-full flex-col items-start justify-start"},Jt={class:"w-full flex flex-col items-start justify-start gap-4"},us=I({__name:"index",setup(h){const s=T(null),t=Vt(),a=T([]);T(void 0),de(),se();const o=[],g=i=>{t.setName(i.name).setImage(i.image).setDescription(i.description),N({query:{step:"type-and-location"}})},j=i=>{t.setEventType(i.event_type).setLocation(i.location).setLocationType(i.location_type).setLatitude(i.location_coordinates.lat).setLongitude(i.location_coordinates.lng),N({query:{step:"schedule"}})},l=i=>{t.setStartDate(i.start_at).setEndDate(i.end_at),N({query:{step:"audience-and-capacity"}})},b=i=>{t.setAudienceType(i.audience).setCapacity(i.capacity),N({query:{step:"tickets-and-pricing"}})},c=async()=>{let i,_;try{const{data:d}=t.buildForm();i=new At(d);const r=await i.execute();_=new Lt(a.value.map(B=>({...B,event_id:r.id}))),await _.execute(),J.success("Event created successfully, redirecting to events"),t.resetFormAndFormBlurred(),o.push(setTimeout(()=>{N("/dashboard/events")},1e3))}catch(d){if(!i||(await i.undo(),!_))return;await _.undo(),console.error("Error building event form:",d),J.error(d instanceof Error?d.message:"Please fill out all required fields before proceeding."),J.error("Something went wrong while creating the event, please try again.");return}},E=i=>{a.value=i,N({query:{step:"final-event-create"}})},y=()=>{console.log("save draft event form")};return ne(()=>{o==null||o.forEach(i=>{clearTimeout(i)})}),z(()=>[t.form,a.value],([i,_])=>{Object.keys(i).length!==0&&(s.value={...i,tickets:_,company_id:null})},{immediate:!0,deep:!0}),ce({title:"Create Event",description:"Create a new event"}),(i,_)=>{const d=Ee,r=re,B=Te,A=ct,M=Ut;return u(),f("div",Yt,[_[6]||(_[6]=e("span",{class:"w-full flex flex-col items-start justify-center gap-3"},[e("h3",{class:"font-semibold text-2xl text-start text-text-primary"}," Create New Event "),e("p",{class:"text-text-secondary"}," Fill out the form below to create a new event. ")],-1)),(u(),S(oe,null,[e("div",Jt,[(i._.provides[q]||i.$route).query.step==="basic-info"||!(i._.provides[q]||i.$route).query.step?(u(),S(n(Mt),{key:0,onBack:_[0]||(_[0]=v=>i.$router.push({query:{step:"final-event-create"}})),onNext:g})):$("",!0),p(r,null,{default:x(()=>[(i._.provides[q]||i.$route).query.step==="type-and-location"&&(i._.provides[q]||i.$route).query.step?(u(),S(d,{key:0,onBack:_[1]||(_[1]=v=>i.$router.push({query:{step:"basic-info"}})),onNext:j})):$("",!0)]),_:1}),(i._.provides[q]||i.$route).query.step==="schedule"&&(i._.provides[q]||i.$route).query.step?(u(),S(B,{key:1,onBack:_[2]||(_[2]=v=>i.$router.push({query:{step:"type-and-location"}})),onNext:l})):$("",!0),(i._.provides[q]||i.$route).query.step==="audience-and-capacity"&&(i._.provides[q]||i.$route).query.step?(u(),S(n(Qt),{key:2,onBack:_[3]||(_[3]=v=>i.$router.push({query:{step:"schedule"}})),onNext:b})):$("",!0),(i._.provides[q]||i.$route).query.step==="tickets-and-pricing"&&(i._.provides[q]||i.$route).query.step?(u(),S(A,{key:3,onBack:_[4]||(_[4]=v=>i.$router.push({query:{step:"audience-and-capacity"}})),"event-capacity":n(t).form.capacity,"event-date":{start_at:n(t).form.start_at,end_at:n(t).form.end_at},onNext:E},null,8,["event-capacity","event-date"])):$("",!0),(i._.provides[q]||i.$route).query.step==="final-event-create"&&(i._.provides[q]||i.$route).query.step?(u(),S(M,{key:4,event:n(s),onOnPublish:c,onOnSaveDraft:y,onOnBack:_[5]||(_[5]=v=>i.$router.push({query:{step:"tickets-and-pricing"}}))},null,8,["event"])):$("",!0)])],1024))])}}});export{us as default};
