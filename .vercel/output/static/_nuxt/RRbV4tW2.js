import Y from"./GQPUnmNe.js";import{_ as J}from"./DmH-Knno.js";import{u as K,A as h,S as Q,a as W,_ as H,V as X,b as Z,C as ee}from"./CzrAGLr7.js";import{_ as te}from"./BHCqIXxc.js";import{d as oe,m as ae,r as P,p as E,s as re,c as ne,g as se,o as le,a as u,h as a,q as f,u as t,j as y,v as ie,x as V,k as b,t as F,l as w,z as g,b as l,B as x,C as _,F as ue,D as de,E as ce}from"./CMCxBn70.js";import{a as me}from"./D2lfmPiW.js";import{_ as ye}from"./DlAUqK2U.js";const pe={class:"min-h-screen flex items-center justify-center bg-[#EAEFEF]"},fe={class:"flex flex-col justify-center items-center w-full md:w-fit rounded-md bg-white p-8 md:p-14 shadow-md"},ge={class:"w-full max-w-sm"},be={class:"mb-8 text-center"},ve={key:0,class:"flex flex-col space-y-4"},xe={class:"grid grid-cols-2 gap-2"},he=["disabled"],we={key:0},_e={key:1,class:"flex flex-col space-y-4"},Ce=["value"],ke=["disabled"],Pe={key:0},Se={key:1},Te={key:2,class:"flex flex-col space-y-4"},Ne={class:"flex flex-col space-y-2"},Oe={class:"w-full grid grid-cols-6 gap-2 bg-zinc-50 p-2 rounded-lg"},Be={class:"w-full flex justify-between items-center gap-4 mt-5"},Ee=["disabled"],Ve=["disabled"],Fe={key:0,class:"text-inherit"},Ue={key:1,class:"text-inherit"},je={class:"text-center mt-4 text-sm text-gray-500"},U=6,$e=oe({__name:"index",setup(Ae){const S=ae(),c=P(!1),s=P(!1),{signIn:T}=useAuth(),{start:j,stop:C,reset:$,isRunning:N,formatted:A}=K(300*1e3),v=P("idle"),o=E({otp:Array(6).fill(""),phoneNumber:"",countryCode:"20",first_name:"",last_name:"",email:"",country:"",city:""}),i=E({otp:!1,phoneNumber:!1,first_name:!1,last_name:!1,email:!1,country:!1,city:!1}),L=[{label:"Egypt",value:"egypt"},{label:"Saudi Arabia",value:"saudi_arabia"},{label:"United Arab Emirates",value:"united_arab_emirates"},{label:"Kuwait",value:"kuwait"},{label:"Qatar",value:"qatar"},{label:"Bahrain",value:"bahrain"},{label:"Oman",value:"oman"},{label:"Jordan",value:"jordan"},{label:"Lebanon",value:"lebanon"},{label:"Syria",value:"syria"},{label:"Iraq",value:"iraq"},{label:"Yemen",value:"yemen"},{label:"Palestine",value:"palestine"},{label:"Sudan",value:"sudan"},{label:"Libya",value:"libya"},{label:"Morocco",value:"morocco"},{label:"Tunisia",value:"tunisia"},{label:"Algeria",value:"algeria"},{label:"Mauritania",value:"mauritania"},{label:"Comoros",value:"comoros"},{label:"Djibouti",value:"djibouti"},{label:"Somalia",value:"somalia"}],d=re("core-info"),O=[],k=ne(()=>o.phoneNumber.startsWith("0")?`${o.countryCode}${o.phoneNumber.slice(1)}`:`${o.countryCode}${o.phoneNumber}`),I=()=>{d.value==="otp"?(d.value="location",$(),C()):d.value==="location"?d.value="core-info":S.push("/register")},M=async n=>{try{s.value=!0;const e=h.createOTPStrategy("sms");await new ee(n,e).execute()}catch(e){s.value=!1,g.error(e instanceof Error?e.message:"Failed to create token"),console.error("Failed to create token:",e)}},B=async()=>{try{s.value=!0,c.value=!1,v.value="idle";const n=h.createOTPStrategy("sms");await new Q(k.value,n).execute(),s.value=!1,c.value=!0,d.value="otp",j(),g.success("OTP sent successfully")}catch(n){v.value="failed",s.value=!1,c.value=!1,g.error(n instanceof Error?n.message:"Failed to send OTP"),console.error("Failed to send OTP:",n)}},q=async()=>{try{s.value=!0;const n=h.createOTPStrategy("sms"),p=await new X(k.value,o.otp.join(""),n).execute();if(s.value=!1,p)v.value="success";else throw v.value="failed",new Error("Invalid OTP code");return g.success("OTP verified successfully"),p}catch(n){s.value=!1,c.value=!1,g.error(n instanceof Error?n.message:"Failed to verify OTP"),console.error("Failed to send OTP:",n)}},G=async n=>{try{s.value=!0;const e=h.createOTPStrategy("sms"),m=await new Z(n,e).execute();if(!m)throw new Error("Failed to create user ,can't find created user id");await M(m.id),s.value=!1,g.success("Your account has been created successfully , redirecting to dashboard",{duration:1e3}),O.push(setTimeout(()=>{S.push("/dashboard")},1e3))}catch(e){s.value=!1,c.value=!1,console.log("error: ",e),g.error(e instanceof Error?e.message:"Failed to sign up new account"),console.error("Failed to sign up:",e)}};return se(()=>o.otp.join("").length,async n=>{n===U&&(C(),await q()&&await G({first_name:o.first_name,last_name:o.last_name,phone:k.value,email:o.email,country:o.country,city:o.city}))}),le(()=>{O.forEach(n=>clearTimeout(n)),C()}),me({title:"register",description:"register new account",keywords:"register, create account, new account"}),(n,e)=>{const p=Y,m=J,z=W,D=H,R=te;return l(),u("div",pe,[a("div",fe,[a("div",ge,[a("div",be,[t(d)!=="core-info"?(l(),u("button",{key:0,type:"button",class:"place-self-center flex items-center justify-center mb-5 aspect-square px-3 py-2 rounded-md bg-primary hover:bg-primary/60 transition-colors duration-200",onClick:I},[y(p,{name:"ic:round-arrow-back-ios",class:"text-2xl text-gray-500 hover:text-gray-700 transition-colors duration-200"})])):f("",!0),e[16]||(e[16]=a("h1",{class:"font-logo text-accent text-3xl mb-5"},"Tajammoa",-1)),e[17]||(e[17]=a("h2",{class:"text-xl font-semibold text-gray-800 mb-1"}," Create New Account ",-1)),e[18]||(e[18]=a("p",{class:"text-gray-500"}," Fill in the form below to create a new account ",-1))]),a("form",{onSubmit:ie(B,["prevent"]),class:"space-y-6"},[t(d)==="core-info"?(l(),u("div",ve,[a("div",xe,[t(c)?f("",!0):(l(),V(m,{key:0,label:"First Name","error-condition":!t(o).first_name&&t(i).first_name,"error-message":"Please enter your first name",direction:"col",id:"first-name"},{default:b(()=>[x(a("input",{type:"text",placeholder:"Enter your first name",class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-200 text-gray-900 placeholder:text-gray-400 bg-gray-50",name:"first-name",id:"first-name","onUpdate:modelValue":e[0]||(e[0]=r=>t(o).first_name=r),onBlur:e[1]||(e[1]=()=>t(i).first_name=!0)},null,544),[[_,t(o).first_name]])]),_:1},8,["error-condition"])),t(c)?f("",!0):(l(),V(m,{key:1,label:"Last Name","error-condition":!t(o).last_name&&t(i).last_name,"error-message":"Please enter your last name",direction:"col"},{default:b(()=>[x(a("input",{type:"text",placeholder:"Enter your last name",class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-200 text-gray-900 placeholder:text-gray-400 bg-gray-50",name:"last-name",id:"last-name","onUpdate:modelValue":e[2]||(e[2]=r=>t(o).last_name=r),onBlur:e[3]||(e[3]=()=>t(i).last_name=!0)},null,544),[[_,t(o).last_name]])]),_:1},8,["error-condition"]))]),a("div",null,[e[19]||(e[19]=a("label",{for:"phone-number",class:"block text-sm font-medium text-gray-700 mb-1"},"Phone Number",-1)),y(z,{modelValue:t(o).phoneNumber,"onUpdate:modelValue":e[4]||(e[4]=r=>t(o).phoneNumber=r),countryCode:t(o).countryCode,"onUpdate:countryCode":e[5]||(e[5]=r=>t(o).countryCode=r),placeholder:"Enter your phone number",error:!t(o).phoneNumber&&t(i).phoneNumber?"Please enter your phone number":void 0},null,8,["modelValue","countryCode","error"])]),y(m,{label:"email","error-condition":!t(o).email&&t(i).email,"error-message":"Please enter your email address",direction:"col"},{default:b(()=>[x(a("input",{type:"email",placeholder:"Enter your email (optional)",class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-200 text-gray-900 placeholder:text-gray-400 bg-gray-50",name:"email",id:"email","onUpdate:modelValue":e[6]||(e[6]=r=>t(o).email=r),onBlur:e[7]||(e[7]=()=>t(i).email=!0)},null,544),[[_,t(o).email]])]),_:1},8,["error-condition"]),a("button",{onClick:e[8]||(e[8]=r=>d.value="location"),type:"button",disabled:!(t(o).phoneNumber&&t(o).first_name&&t(o).last_name)||t(s),class:"w-full py-3 mt-10 rounded-lg bg-gray-800 hover:bg-gray-900 text-white font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow"},[t(s)?f("",!0):(l(),u("span",we,"next"))],8,he)])):f("",!0),t(d)==="location"?(l(),u("div",_e,[y(m,{label:"Country","error-condition":!t(o).country&&t(i).country,"error-message":"Please enter your country",direction:"col"},{default:b(()=>[x(a("select",{name:"country",id:"country","onUpdate:modelValue":e[9]||(e[9]=r=>t(o).country=r),onBlur:e[10]||(e[10]=()=>t(i).country=!0),class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-200 text-gray-900 placeholder:text-gray-400 bg-gray-50"},[e[20]||(e[20]=a("option",{value:"",disabled:"",selected:""},"Select your country",-1)),(l(),u(ue,null,de(L,r=>a("option",{key:r.value,value:r.value},F(r.label),9,Ce)),64))],544),[[ce,t(o).country]])]),_:1},8,["error-condition"]),y(m,{label:"City","error-condition":!t(o).city&&t(i).city,"error-message":"Please enter your city",direction:"col"},{default:b(()=>[x(a("input",{type:"text",placeholder:"Enter your city",class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-200 text-gray-900 placeholder:text-gray-400 bg-gray-50",name:"city",id:"city","onUpdate:modelValue":e[11]||(e[11]=r=>t(o).city=r),onBlur:e[12]||(e[12]=()=>t(i).city=!0)},null,544),[[_,t(o).city]])]),_:1},8,["error-condition"]),a("button",{type:"submit",disabled:!(t(o).country&&t(o).city&&t(o).phoneNumber&&t(o).first_name&&t(o).last_name)||t(s),class:"w-full py-3 mt-10 rounded-lg bg-gray-800 hover:bg-gray-900 text-white font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow"},[t(s)?(l(),u("span",Se,[y(p,{name:"line-md:loading-twotone-loop",class:"text-3xl animate-spin text-white"})])):(l(),u("span",Pe," sign up "))],8,ke)])):f("",!0),t(d)==="otp"?(l(),u("div",Te,[e[23]||(e[23]=a("div",{class:"flex items-center justify-between mb-4"},[a("h3",{class:"text-lg font-semibold text-gray-800"}," Enter OTP Code ")],-1)),a("div",Ne,[e[22]||(e[22]=a("label",{for:"code",class:"text-sm capitalize font-medium text-text-secondary"},"code",-1)),a("div",Oe,[y(D,{modelValue:t(o).otp,"onUpdate:modelValue":e[13]||(e[13]=r=>t(o).otp=r),"otp-length":U,"verify-status":t(v)},null,8,["modelValue","verify-status"])]),a("span",Be,[a("button",{type:"button",class:"text-sm font-semibold text-accent capitalize underline",disabled:t(c)||t(s)},e[21]||(e[21]=[a("p",null,"send to email",-1)]),8,Ee),a("button",{type:"button",class:"text-sm font-semibold text-accent underline",disabled:t(N)||t(s),onClick:B},[t(N)?(l(),u("p",Ue,F(t(A)),1)):(l(),u("p",Fe,"re-send"))],8,Ve)])])])):f("",!0),e[28]||(e[28]=a("div",{class:"flex items-center my-2"},[a("div",{class:"flex-1 h-px bg-gray-200"}),a("span",{class:"mx-3 text-gray-400 text-sm"},"or"),a("div",{class:"flex-1 h-px bg-gray-200"})],-1)),a("button",{type:"button",class:"w-full flex items-center justify-center gap-2 py-3 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 text-gray-700 font-medium transition-all duration-200",onClick:e[14]||(e[14]=r=>t(T)("google"))},e[24]||(e[24]=[a("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"Google",class:"w-5 h-5"},null,-1),w(" Sign up with Google ")])),a("button",{type:"button",class:"w-full flex items-center justify-center gap-2 py-3 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 text-gray-700 font-medium transition-all duration-200",onClick:e[15]||(e[15]=r=>t(T)("github"))},e[25]||(e[25]=[a("img",{src:"https://www.svgrepo.com/show/448447/github.svg",alt:"Google",class:"w-5 h-5"},null,-1),w(" Sign up with github ")])),a("div",je,[e[27]||(e[27]=w(" Already have an account? ")),y(R,{to:"/",class:"text-accent hover:underline"},{default:b(()=>e[26]||(e[26]=[w("Login")])),_:1,__:[26]})])],32)])])])}}}),Re=ye($e,[["__scopeId","data-v-660e3305"]]);export{Re as default};
